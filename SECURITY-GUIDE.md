# OpenClaw 보안 가이드

> **원본 문서:** [OpenClaw Security Guide](https://docs.openclaw.ai/gateway/security)

이 문서는 OpenClaw Gateway의 보안 모델, 위협 요소, 권장 설정 및 알려진 취약점 방어에 대한 상세 정보를 담고 있습니다. AI 에이전트에게 셸(Shell) 접근 권한이나 도구 사용 권한을 부여하는 것은 강력하지만 위험할 수 있으므로, 아래 지침을 반드시 숙지하시기 바랍니다.

---

## 목차

- [빠른 점검: 보안 오딧](#-빠른-점검-보안-오딧)
- [오딧 점검 항목](#-오딧-점검-항목)
- [자격 증명 저장소 맵](#️-자격-증명-저장소-맵)
- [위협 모델](#️-위협-모델)
- [핵심 개념: 접근 제어](#-핵심-개념-접근-제어)
- [네트워크 및 인터페이스 보안](#-네트워크-및-인터페이스-보안)
- [로컬 데이터 및 실행 보안](#-로컬-데이터-및-실행-보안)
- [프롬프트 인젝션](#-프롬프트-인젝션)
- [알려진 보안 이슈](#-알려진-보안-이슈)
- [침해 사고 대응](#️-침해-사고-대응)
- [설정 강화 예시](#️-설정-강화-예시)

---

## ⚡ 빠른 점검: 보안 오딧

설정을 변경하거나 네트워크 환경을 수정한 후에는 반드시 정기적으로 다음 명령어를 실행하십시오.

```bash
openclaw security audit
openclaw security audit --deep
openclaw security audit --fix
```

이 명령어는 일반적인 실수(게이트웨이 인증 노출, 브라우저 제어 노출, 권한 상승 허용 목록, 파일 시스템 권한 등)를 찾아냅니다. `--fix` 옵션은 다음과 같은 안전 장치를 자동으로 적용합니다:

* 공용 채널의 그룹 정책을 `open`에서 `allowlist`로 강화
* 로그 내 민감 정보 마스킹(`logging.redactSensitive`)을 다시 활성화
* 로컬 권한 강화 (`~/.openclaw` → 700, 설정 파일 → 600 등)

---

## 🔍 오딧 점검 항목

* **인바운드 접근:** DM/그룹 정책 및 허용 목록을 통해 외부인이 봇을 트리거할 수 있는지 확인
* **도구 영향 범위:** 권한 상승 도구나 공개된 방에서 프롬프트 인젝션이 셸/파일/네트워크 작업으로 이어질 수 있는지 확인
* **네트워크 노출:** 게이트웨이 바인딩/인증, Tailscale Serve/Funnel 노출 여부
* **브라우저 제어 노출:** 원격 노드, 릴레이 포트, 원격 CDP 엔드포인트 확인
* **로컬 디스크 위생:** 권한, 심볼릭 링크, 설정 포함 경로 등 점검
* **플러그인:** 명시적인 허용 목록 없이 존재하는 확장 프로그램 확인
* **모델 위생:** 구형 모델 사용 시 경고 (차단은 아니나 권장 사항)

---

## 🗺️ 자격 증명 저장소 맵

접근 권한을 감사하거나 백업 시 다음 경로를 확인하십시오:

| 항목 | 경로 |
|------|------|
| WhatsApp | `~/.openclaw/credentials/whatsapp/<accountId>/creds.json` |
| Telegram 봇 토큰 | `config/env` 또는 `channels.telegram.tokenFile` |
| Discord 봇 토큰 | `config/env` |
| Slack 토큰 | `config/env` (`channels.slack.*`) |
| 페어링 허용 목록 | `~/.openclaw/credentials/<channel>-allowFrom.json` |
| 모델 인증 프로필 | `~/.openclaw/agents/<agentId>/agent/auth-profiles.json` |

---

## 🛡️ 위협 모델

### AI 어시스턴트의 권한

* 임의의 셸 명령 실행
* 파일 읽기 및 쓰기
* 네트워크 서비스 접근
* 메시지 전송 (연결된 채널을 통해)

### 외부 위협 요소

* AI를 속여 악의적인 행위를 수행하도록 유도
* 데이터 접근을 위한 사회 공학적 공격
* 인프라 상세 정보 탐색

---

## 🔑 핵심 개념: 접근 제어

OpenClaw의 기본 입장은 다음과 같습니다:

1. **ID 확인 (Identity First):** 누가 봇과 대화할 수 있는가? (DM 페어링, 허용 목록)
2. **범위 설정 (Scope Next):** 봇이 어디서 활동할 수 있는가? (그룹 허용 목록, 멘션 게이팅, 도구, 샌드박싱)
3. **모델 (Model Last):** 모델이 조작될 수 있다고 가정하고, 조작 시 피해 범위를 제한하도록 설계

---

## 🌐 네트워크 및 인터페이스 보안

### HTTP 환경에서의 제어 UI

제어 UI는 기기 ID 생성을 위해 보안 컨텍스트(HTTPS 또는 localhost)가 필요합니다.

* `gateway.controlUi.allowInsecureAuth`: 토큰 전용 인증으로 대체되며 기기 페어링을 건너뜁니다. 이는 **보안 등급 저하**입니다.
* `gateway.controlUi.dangerouslyDisableDeviceAuth`: 기기 인증 체크를 완전히 비활성화합니다. **매우 위험**하며 디버깅 시에만 일시적으로 사용해야 합니다.

### 리버스 프록시 설정

Nginx, Caddy 등을 사용하는 경우 `gateway.trustedProxies`를 설정하여 클라이언트 IP를 올바르게 감지해야 인증 우회를 방지할 수 있습니다.

### 네트워크 검증

설정 후 실제로 외부 통신이 차단되었는지 확인하려면:

```bash
# 게이트웨이 실행 중 네트워크 연결 확인 (macOS)
lsof -i -P | grep openclaw

# 또는 특정 포트만 확인
netstat -an | grep ESTABLISHED | grep -v "127.0.0.1\|namc-aigw"
```

---

## 📂 로컬 데이터 및 실행 보안

### 로컬 세션 로그

세션 기록은 `~/.openclaw/agents/<agentId>/sessions/*.jsonl`에 저장됩니다. 파일 시스템 접근 권한이 있는 사용자는 이를 읽을 수 있으므로, 디렉토리 권한을 엄격히 제한하십시오.

### 노드 실행 (system.run)

macOS 노드가 페어링된 경우 게이트웨이는 해당 맥에서 `system.run`을 호출할 수 있습니다. 이는 **원격 코드 실행(RCE)** 권한과 같으므로 노드 페어링 시 신중해야 합니다.

### 플러그인 및 확장 프로그램

플러그인은 게이트웨이 프로세스 내에서 실행됩니다. 반드시 신뢰할 수 있는 소스의 플러그인만 설치하고, 설치 후에는 코드를 검토한 뒤 게이트웨이를 재시작하십시오.

---

## 🤖 프롬프트 인젝션

본인만 봇을 사용하더라도, 봇이 읽는 **외부 콘텐츠**(웹 페이지, 이메일, 문서 등)에 악의적인 지침이 포함되어 있을 수 있습니다.

### 대응 전략

* **신뢰할 수 없는 콘텐츠 요약:** 도구가 비활성화된 '읽기 전용' 에이전트를 사용하여 먼저 요약하고, 그 결과를 메인 에이전트에게 전달하십시오.
* **샌드박싱:** 신뢰할 수 없는 입력을 처리하는 모든 에이전트에 대해 샌드박싱을 활성화하십시오.
* **모델 선택:** 도구를 사용하는 봇에는 최신 세대의 최고 성능 모델(예: Claude Sonnet 4.5)을 사용하십시오. 성능이 낮은 모델은 지침 가로채기에 취약합니다.

---

## 🚨 알려진 보안 이슈

2026년 1월 SOC Prime과 Noma Security에서 발표한 위협 보고서에 따르면, Moltbot(구 Clawdbot) 인스턴스에서 다음과 같은 보안 결함이 발견되었습니다.

> **본 문서의 권장 설정을 적용하면 아래 보안 이슈들을 효과적으로 방어할 수 있습니다.**

| 보안 이슈 | 방어 설정 |
|-----------|-----------|
| 관리자 포트 노출 | `--bind loopback` 옵션으로 로컬 접근만 허용 |
| 평문 자격증명 | 환경 변수 사용 + 파일 권한 제한 (`chmod 600`) |
| 공급망 공격 | 외부 스킬 설치 금지, 사내 환경 격리 |
| 과도한 권한 | 전용 서비스 계정 사용, root 실행 금지 |
| Prompt Injection | 채널 allowlist로 사내 Slack만 허용 |
| 외부 데이터 유출 | 사내 모델 엔드포인트 + 웹 도구 비활성화 |

### 1. 인증되지 않은 관리자 포트 노출

- 수백 개의 인스턴스가 인증 없이 관리자 포트(8080)를 인터넷에 노출
- 약하거나 미흡한 인증 메커니즘으로 인한 무단 접근 위험

**대응:** 게이트웨이 실행 시 `--bind loopback` 옵션 사용

### 2. 평문 자격증명 저장

- JSON 및 Markdown 파일에 사용자 자격증명이 평문으로 저장됨
- RedLine, Lumma, Vidar 등 정보 탈취 악성코드에 취약

**대응:** 자격증명은 환경 변수로 관리, 설정 파일 권한을 `600`으로 제한

### 3. 스킬 라이브러리 공급망 공격

- 원격 명령 실행(RCE)이 다운스트림 사용자에게 확산될 위험

**대응:** 신뢰할 수 없는 외부 스킬 설치 금지, 사내 환경에서는 스킬 설치 기능 비활성화 권장

### 4. 과도한 권한 부여

Noma Security 연구에 따르면, 엔터프라이즈 고객의 53%가 ClawdBot에 특권 접근 권한을 부여한 것으로 나타났습니다.

- 지속적 백그라운드 서비스로 운영되며 WhatsApp, Teams, Slack 등을 통해 원격 접근 가능
- Root 사용자로 실행 시 커널에 대한 완전한 제어 가능

**대응:** 최소 권한 원칙 적용 (root 실행 금지), 전용 서비스 계정으로 실행, 샌드박스 환경에서 격리 실행

### 5. Prompt Injection 공격 취약점

- 임의 셸 명령어 실행 능력으로 인해 prompt injection 공격에 취약
- 역프록시 뒤에서 제어 평면 노출 시 인증 없는 원격 명령 실행 위험

**대응:** 채널 allowlist를 통한 접근 경로 제한, 웹 검색/페치 도구 비활성화

### 잠재적 영향

| 위협 유형 | 설명 |
|-----------|------|
| 소스 코드 탈취 | 개발 환경의 코드가 외부로 유출될 수 있음 |
| 원격 명령 실행 (RCE) | 공격자가 시스템에서 임의 명령 실행 가능 |
| 자격증명 탈취 | API 키, 토큰 등 민감 정보 유출 |
| 백도어 설치 | 시스템이 지속적인 공격 거점으로 활용될 수 있음 |
| 횡적 이동 | 탈취한 권한으로 내부 네트워크 추가 침투 가능 |

### 출처

- SOC Prime, "The Moltbot/Clawdbot's Epidemic" (2026-01-28)
  https://socprime.com/active-threats/the-moltbot-clawdbots-epidemic/
- Noma Security, "53% of our Enterprise Customers Gave ClawdBot Privileged Access" (2026-01)
  https://noma.security/blog/customers-gave-clawdbot-privileged-access-and-noone-asked-permission/

---

## ⚠️ 침해 사고 대응

시스템 침해가 의심되는 경우 다음과 같이 조치하십시오:

1. **격리 (Contain):** 게이트웨이 프로세스를 즉시 중단하십시오.
2. **교체 (Rotate):** 비밀번호, API 키, 봇 토큰 등 모든 자격 증명을 탈취된 것으로 간주하고 교체하십시오.
3. **감사 (Audit):** 로그를 수집하여 보고서를 작성하고 노출 범위를 파악하십시오.

---

## 🛠️ 설정 강화 예시

* **파일 권한:** `~/.openclaw` 디렉토리를 700 권한으로 설정
* **네트워크:** 게이트웨이 웹소켓을 로컬 인증으로 잠금 (`--bind loopback`)
* **DM 정책:** 기본적으로 `pairing` 모드 사용
* **그룹 정책:** 모든 그룹에서 반드시 멘션(`@bot`)이 있어야만 응답하도록 설정
* **읽기 전용 모드:** 샌드박스 및 도구 설정을 통해 파일 시스템/셸 접근이 없는 읽기 전용 환경 구축
* **웹 도구 비활성화:** 외부 데이터 유출 방지

### 최고보안 프리셋

원클릭 설정을 원한다면 [보안 프리셋 가이드](./SECURITY-PRESETS.md)를 참조하세요.

---

## 관련 문서

- [보안 프리셋 가이드](./SECURITY-PRESETS.md) - 최고보안/중간보안/실용성 프리셋
- [NAMC 프로바이더 가이드](./NAMC-PROVIDER-GUIDE.md) - 사내 모델 설정
- [샌드박스 설정 가이드](./SANDBOX-SETUP.md) - Docker 격리 설정

---

본 문서는 회사 내 보안 규정을 준수하며 OpenClaw를 운영하기 위한 가이드라인입니다. 추가적인 보안 이슈 발견 시 관리자에게 즉시 보고해 주시기 바랍니다.
